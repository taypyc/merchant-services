$(function(){var t=!1,e=$("<a />").addClass("scroll-up").attr({href:"#"}).append($('<svg class="icon icon-arrow-top"><use xlink:href="css/fonts/icons.svg#arrow-top"></use></svg>'));$("body").append(e),e.on("click",function(e){return e.preventDefault(),!t&&300<$(window).scrollTop()&&(t=!0,$("body, html").animate({scrollTop:0},500,function(){t=!1})),!1});var a=!1;$(window).scroll(function(){a||(a=!0,a=(300<$(window).scrollTop()?e.stop(!0,!0).addClass("visible"):e.stop(!0,!0).removeClass("visible"),!1))})}),$(function(){var e=bowser.getParser(window.navigator.userAgent),t=e.parsedResult.browser.name,a=e.parsedResult.os.name,e=e.parsedResult.platform.type;"Internet Explorer"==t&&$("html").addClass("ms-ie"),"Microsoft Edge"==t&&$("html").addClass("ms-edge"),"Opera"==t&&$("html").addClass("opera"),"macOS"==a&&$("html").addClass("macos"),"mobile"==e||"tablet"==e?$("html").addClass("mt-device"):$("html").addClass("desktop-device")}),$(function(){$.ajax({method:"POST",url:"php/store-data.php",data:{url:window.location.href},dataType:"json"})}),$(function(){$.fn.extend({disable:function(t){return this.each(function(){var e=$(this);e.prop("disabled",t),!0===t&&void 0!==e.data("loading-content")&&(e.data("original-content",e.html()),e.html(e.data("loading-content"))),!1===t&&void 0!==e.data("original-content")&&e.html(e.data("original-content"))})}}),$.extend($.validator.messages,{required:"Campo Requerido."}),$.validator.addMethod("validEmail",function(e,t){var a=$.validator.methods.email.bind(this),n=e.slice(e.lastIndexOf("@")+1),n=-1<n.indexOf(".")&&2<=n.slice(n.lastIndexOf(".")+1).length;return this.optional(t)||a(e,t)&&n},function(e,t){return"Por favor entre un correo electrónico válido."}),$.validator.addMethod("validString",function(e,t){return this.optional(t)||0<$.trim(e).length},$.validator.format("Por favor entre una información válida.")),$.validator.addMethod("validExactLength",function(e,t,a){return this.optional(t)||e.length==a},$.validator.format("Favor entrar exáctamente {0} caracteres.")),$.validator.addMethod("validPhone",function(e,t){return this.optional(t)||/^\(\d{3}\)\s\d{3}-\d{4}$/.test(e)},function(e,t){return"Formato Teléfono (XXX) XXX-XXXX."}),$.validator.addMethod("validZip",function(e,t){return this.optional(t)||/^\d{5}$/.test(e)},function(e,t){return"Formato de Código Postal XXXXX"}),$.validator.addMethod("validTax",function(e,t){return this.optional(t)||/^\d{2}-\d{7}$/.test(e)},function(e,t){return"Formato Seguro Social Patronal XX-XXXXXXX"}),$.validator.addMethod("validSSN",function(e,t){return this.optional(t)||/^\d{3}-\d{2}-\d{4}$/.test(e)},function(e,t){return"Formato SSN XXX-XX-XXXX."}),$.validator.addMethod("validUrl",function(e,t){var a=$.validator.methods.url.bind(this);return a(e,t)||a("http://"+e,t)},function(e,t){return"Favor de entrar URL válido."}),$.validator.addMethod("validDateFull",function(e,t){return this.optional(t)||function(e){if(!/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(e))return!1;var t=e.split("/"),a=parseInt(t[0],10),n=parseInt(t[1],10),e=parseInt(t[2],10),t=new Date;return!(e<1900||e>t.getFullYear()||0==a||12<a)&&(t=[31,28,31,30,31,30,31,31,30,31,30,31],(e%400==0||e%100!=0&&e%4==0)&&(t[1]=29),0<n&&n<=t[a-1])}(e)},function(e,t){return"Forma de Fecha MM/DD/YYYY"}),$.validator.addMethod("validDateMonth",function(e,t){return this.optional(t)||function(e){if(!/^\d{1,2}\/\d{4}$/.test(e))return!1;var t=e.split("/"),a=parseInt(t[0],10),e=parseInt(t[1],10),t=new Date;return!(e<1613||e>t.getFullYear()||0==a||12<a)}(e)},function(e,t){return"Forma de Fecha MM/YYYY"}),$.validator.addMethod("validDateYear",function(e,t){return this.optional(t)||function(e){if(!/^\d{4}$/.test(e))return!1;var t=new Date;return!(e<1613||e>t.getFullYear())}(e)},function(e,t){return"Forma de Fecha YYYY"}),$(".form-application").each(function(){$(this).validate({ignore:".fa-step-item:not(.slick-active) .form-control, :hidden",rules:{line_of_credit:{required:function(e){return"Yes"==$('[name="bank_credit"]').val()}}},submitHandler:function(e){var t=(e=$(e)).find('[type="submit"]'),e=e.serializeArray();t.disable(!0),a.loaderState("show"),(window.dataLayer||[]).push({event:"submit_form",completed_step:"Step DS"}),e.push({name:"step",value:"ds-init"}),$.ajax({method:"POST",url:"php/form-application.php",data:e,dataType:"json",complete:function(e){if("object"==typeof e.responseJSON){if("success"==e.responseJSON.response)return void(window.location.href=e.responseJSON.r);alert("Al parecer tenemos un problema temporero. Por favor verifique todos los campos.")}else alert("Error no definido, trate otra vez luego.");t.disable(!1),a.loaderState("hide")}})},errorClass:"error",errorPlacement:function(e,t){t=$(t);t.hasClass("select-item")?e.insertAfter(t.next()):"radio"==t.attr("type")||"checkbox"==t.attr("type")?e.insertAfter(t.closest(".check-wrap")):e.insertAfter(t)},highlight:function(e,t,a){e=$(e);(e.hasClass("select-item")?e.next():e).addClass(t)},unhighlight:function(e,t,a){e=$(e);(e.hasClass("select-item")?e.next():e).removeClass(t)}})});for(var e=["business_name","owner_name","owner_1_first_name","owner_1_last_name","business_time","monthly_sales","owner_1_cell_phone","owner_1_email","business_legal_name","industry_type","amount_requested","amount_requested_for","bankruptcy","work_from_home","website","business_phone","business_email","physical_address","physical_city","physical_state","physical_zip","mailing_address","mailing_city","mailing_state","mailing_zip","owner_1_title","owner_1_dob","owner_1_address","owner_1_city","owner_1_state","owner_1_zip","owner_1_own","owner_1_own_years","owner_1_ssn","owner_2_first_name","owner_2_last_name","owner_2_title","owner_2_dob","owner_2_cell_phone","owner_2_email","owner_2_address","owner_2_city","owner_2_state","owner_2_zip","owner_2_own","owner_2_own_years","owner_2_ssn","entity_type","state_incorporation","property_ownership","tax_id","business_started_date","actual_cash_advance_company","bank_credit","accept_credit_cards","monthly_total_sales"],t=0;t<e.length;t++)$('[name="'+e[t]+'"]').rules("add","required");$("[data-field-string]").each(function(){$(this).rules("add","validString")}),$('[type="email"]').each(function(){$(this).rules("add",{email:!1}),$(this).rules("add","validEmail")}),$('[name="business_term"]').rules("add","validDateYear"),$("[data-mask-date]").each(function(){$(this).rules("add","validDateFull")}),$("[data-field-address]").each(function(){$(this).rules("add",{maxlength:255})}),$("[data-field-city]").each(function(){$(this).rules("add",{maxlength:50})}),$("[data-mask-phone]").each(function(){$(this).rules("add","validPhone")}),$("[data-mask-zip]").each(function(){$(this).rules("add","validZip")}),$("[data-mask-tax]").each(function(){$(this).rules("add","validTax")}),$("[data-mask-percentage]").each(function(){$(this).rules("add",{min:1,max:100})}),$("[data-mask-ssn]").each(function(){$(this).rules("add","validSSN")}),$("[data-mask-url]").each(function(){$(this).rules("add","validUrl")}),$('[name="service"]').rules("add",{messages:{required:"Please select device"}}),$('[name="service"]').on("change",function(){$(this).valid()});$(document).on("mask-it",function(){$("[data-mask-phone]").mask("(000) 000-0000"),$("[data-mask-zip]").mask("00000"),$("[data-mask-tax]").mask("00-0000000"),$("[data-mask-ssn]").mask("000-00-0000"),$("[data-mask-rn]").mask("000000000"),$("[data-mask-an]").mask("00000999999999999"),$("[data-mask-percentage]").mask("990",{clearIfNotMatch:!0,reverse:!0}),$("[data-mask-date]").mask("00/00/0000"),$("[data-mask-date-01]").mask("0000"),$("[data-mask-money]").each(function(){var i=$(this),r={onKeyPress:function(e,t,a,n){var o=["$0#","$0 00#","$00 000#","$000 000#","$0 000 000#","$00 000 000#","$000 000 000"],s="$0#",e=e.replace(/\s/g,"");e.length<=4?s=o[0]:5==e.length?s=o[1]:6==e.length?s=o[2]:7==e.length?s=o[3]:8==e.length?s=o[4]:9==e.length?s=o[5]:10==e.length&&(s=o[6]),i.mask(s,r)},clearIfNotMatch:!0,placeholder:"$"};i.mask("$0#",r)})}).trigger("mask-it"),$(".select-item").each(function(){var e=$(this);e.select2({placeholder:e.data("select-placeholder")&&0<e.data("select-placeholder").length?e.data("select-placeholder"):"Please select...",allowClear:!0,minimumResultsForSearch:e.is("[data-select-input]")?0:1/0})}),$(".select-item").on("change.s2v",function(){$(this).valid()}),$("[data-select-input]").on("select2:open",function(){$(".select2-search__field").focus()}),$("[data-mask-rn]").each(function(){$(this).rules("add",{validExactLength:9})}),$("[data-mask-an]").each(function(){$(this).rules("add",{minlength:5,maxlength:17})});var a={form:$(".application-form-steps"),completedSteps:[],finalStepNum:1==$(".application-form-steps").children().length?0:$(".application-form-steps").children().length-1,currentStep:function(){return this.form.slick("slickCurrentSlide")},formBtnActivate:function(){this.form.find('[type="submit"]').prop("disabled",!1)},goToNextStep:function(e){var t=this,a=e.closest(".fa-step-item"),n=!0,o=!1,s=t.currentStep();a.find(".form-control").each(function(){$(this).valid()||(n=!1)===o&&(o=$(this))}),n?((window.dataLayer||[]).push({event:"submit_form",completed_step:"Step "+t.determinateDappStep(s,"input_step")}),-1==t.completedSteps.indexOf(t.determinateDappStep(s,"form_step"))&&t.saveInfo(e)):o.focus()},saveInfo:function(e){var t=this,a=t.form.serializeArray(),n=!1,o=t.currentStep(),s=$('[name="id"]');$('[name="signupCountry"]');t.loaderState("show"),void 0!==e&&e.disable(n=!0),t.determinateDappStep(o,"form_step")==t.finalStepNum-1&&t.formBtnActivate(),$.ajax({method:"POST",url:"php/form-application.php",data:a,dataType:"json",complete:function(e){if("object"==typeof e.responseJSON&&"success"==e.responseJSON.response){if(1<e.responseJSON.r.length)return void(window.location.href=e.responseJSON.r);e=t.parseJson(e.responseJSON.d);"object"==typeof e&&s.val(e.id)}!0===n&&t.changeStep(o+1),t.loaderState("hide")}})},parseJson:function(e){try{var t=JSON.parse(e);if(t&&"object"==typeof t)return t}catch(e){}return!1},changeStep:function(e){var t=this,a=$("#header").outerHeight(),n=t.currentStep(),o=t.determinateDappStep(e,"input_step");-1==t.completedSteps.indexOf(n)&&t.completedSteps.push(n),setTimeout(function(){$("html, body").scrollTop(a),t.form.slick("slickGoTo",e),$('[name="step"]').val(o),t.setHeaderStep()},1)},setHeaderStep:function(){var e,t=$(".afw-steps-progress > .d-flex"),a=this.currentStep();e=a,t.children().eq(e).addClass("active").prevAll().filter(function(e){return!$(this).hasClass("completed")}).addClass("completed")},continueFromStep:function(){var e=this,t=$('[name="step"]').val(),a=parseInt(t,10),t=e.form.attr("data-form-cs"),a=e.determinateDappStep(a,"form_step");void 0!==t&&!1!==t&&e.currentStep()!==a&&(a==e.finalStepNum&&e.formBtnActivate(),e.form.slick("slickGoTo",a,!0)),e.form.addClass("form-application-initialized")},showSignupData:function(){var e=$('[name="monthly_sales"]').val(),t="250,000",a=$("#qualify-result");switch(e){case"$0 - $4,999":t="5,000";break;case"$5,000 - $9,999":t="10,000";break;case"$10,000 - $24,999":t="25,000";break;case"$25,000 - $49,999":t="50,000";break;case"$50,000 - $99,999":t="100,000";break;case"$100,000 - $249,999":t="250,000";break;case"$250,000+":t="500,000"}a.text("$"+t)},determinateDappStep:function(e,t){return e},loaderState:function(e){var t=$(".loader-wrap"),a="loader-active";"show"==e?t.addClass(a):"hide"==e&&t.removeClass(a)},showSignupCountry:function(){$('[name="signup_country"]').length&&$('[name="signup_country"]').val()},collapseElem:function(e){this.collapseAction(e,"fadeToggle")},collapseAction(e,t){$(e.data("collapsable-elem")).stop(!0,!0)[t](0),this.form[0].slick.refresh()},determinateSigners:function(e,t){var a=e.val(),n="",o=$(e.data("collapsable-elem")).is(":visible");("keyup"==t.type&&10<a&&a<80||"change"==t.type&&a<80)&&!o?n="fadeIn":("keyup"==t.type&&80<=a||"change"==t.type&&80<=a||"change"==t.type&&0==a.length)&&o&&(n="fadeOut"),0<n.length&&(this.collapseAction(e,n),"keyup"==t.type&&e.focus())},fillOwner1Name:function(e){var t=e.val(),e=t.split(" ").slice(0,-1).join(" ").trim(),t=t.split(" ").slice(-1).join(" ").trim();0==e.length&&0<t.length&&(e=t,t=""),$('[name="owner_1_first_name"]').val(e),$('[name="owner_1_last_name"]').val(t)}};$("button[data-form-next-step]").on("click",function(){a.goToNextStep($(this))}),$('[data-collapsable-elem]:not([name="owner_1_own"])').on("change",function(){a.collapseElem($(this))}),$('[name="owner_1_own"]').on("change keyup",function(e){a.determinateSigners($(this),e)}),$('[name="business_name"]').on("keyup focusout",function(){$('[name="business_legal_name"]').val($(this).val())}),$('[name="owner_name"]').on("keyup focusout",function(){a.fillOwner1Name($(this))}),$('[name="monthly_sales"]').on("change",function(){a.showSignupData()}),$(".application-form-steps").slick({dots:!1,arrows:!1,draggable:!1,swipe:!1,touchMove:!1,fade:!0,infinite:!1,speed:400,slidesToShow:1,adaptiveHeight:!0,accessibility:!1}),a.showSignupData(),a.continueFromStep(),a.setHeaderStep()}),$(function(){var t=!1;$(".fa-step-item .form-control").each(function(){$(this).on("focus",function(){var e=$(this);!1===t&&(t=e),e.closest(".fa-step-item").hasClass("slick-active")?t=e:t.focus()})}),$(".fa-step-item").each(function(){$(this).find(".form-control").each(function(a,e){var e=$(e),n=e.closest(".fa-step-item").find(".form-control");e.keydown(function(e){var t;9===(e.keyCode||e.which)&&(t=a==n.length-1?0:a+1,n[t].focus(),e.preventDefault())})})})});