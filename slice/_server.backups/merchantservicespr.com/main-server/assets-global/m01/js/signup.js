$(function(){var e=!1,t=$(".hb-cart-service-list"),a=$(".hb-cart-service-selected");function i(){e=!0,setTimeout(function(){e=!1},150),a.removeClass("active"),t.removeClass("active")}function s(e){var t=$(".hb-cart").find('[data-service="'+e+'"]'),e=$(".fa-step-device").find('[data-service="'+e+'"]');$(".hb-cart-service-list li").removeClass("active"),t.addClass("active"),$(".fa-step-device .tile-img-info-link").removeClass("active"),e.addClass("active"),$(".hb-cart-01 .hbc-main").html(t.find("> span").text()),$(".hb-cart-01 .hbc-highlighted").html(t.find(".hb-cart-service-list-price > span:first-child").html()),$(".hb-cart-01 .hbc-old").html(t.find(".hb-cart-service-list-price > span:last-child").html()),function(e){{var t;history.replaceState&&(t=window.location.search,history.replaceState(null,null,e+t))}}(t.data("service-url")),$('[name="service"]').val(t.data("service")),$('[name="service"]').trigger("change"),$(".hb-cart-01").hasClass("visible")||$(".hb-cart-01").addClass("visible"),i()}$(".hb-cart-service-selected").on("click",function(){e||($(".hb-cart-service-selected").toggleClass("active"),$(".hb-cart-service-list").toggleClass("active"))}),$(document).on("mouseup touchstart",function(e){!t.hasClass("active")||t.is(e.target)||0!==t.has(e.target).length||a.is(e.target)||0!==a.has(e.target).length||i()}),$('[name="service"]').length&&0<$('[name="service"]').val().length&&s($('[name="service"]').val()),$(".hb-cart").hasClass("hb-cart-visible")||$(".hb-cart").addClass("hb-cart-visible"),$(".hb-cart-service-list li").on("click",function(){s($(this).data("service"))}),$(".fa-step-device .tile-img-info-link").on("click",function(){s($(this).data("service"))})}),$(function(){$.fn.extend({disable:function(t){return this.each(function(){var e=$(this);e.prop("disabled",t),!0===t&&void 0!==e.data("loading-content")&&(e.data("original-content",e.html()),e.html(e.data("loading-content"))),!1===t&&void 0!==e.data("original-content")&&e.html(e.data("original-content"))})}}),$.validator.addMethod("validEmail",function(e,t){var a=$.validator.methods.email.bind(this),i=e.slice(e.lastIndexOf("@")+1),i=-1<i.indexOf(".")&&2<=i.slice(i.lastIndexOf(".")+1).length;return this.optional(t)||a(e,t)&&i},function(e,t){return"Please enter a valid email address."}),$.validator.addMethod("validString",function(e,t){return this.optional(t)||0<$.trim(e).length},$.validator.format("Please enter a valid info.")),$.validator.addMethod("validExactLength",function(e,t,a){return this.optional(t)||e.length==a},$.validator.format("Please enter {0} characters")),$.validator.addMethod("validPhone",function(e,t){return this.optional(t)||/^\(\d{3}\)\s\d{3}-\d{4}$/.test(e)},function(e,t){return"Phone format (XXX) XXX-XXXX"}),$.validator.addMethod("validZip",function(e,t){return this.optional(t)||/^\d{5}$/.test(e)},function(e,t){return"Zip format XXXXX"}),$.validator.addMethod("validTax",function(e,t){return this.optional(t)||/^\d{2}-\d{7}$/.test(e)},function(e,t){return"Tax ID format XX-XXXXXXX"}),$.validator.addMethod("validSSN",function(e,t){return this.optional(t)||/^\d{3}-\d{2}-\d{4}$/.test(e)},function(e,t){return"SSN format XXX-XX-XXXX"}),$.validator.addMethod("validUrl",function(e,t){var a=$.validator.methods.url.bind(this);return a(e,t)||a("http://"+e,t)},function(e,t){return"Please enter a valid URL."}),$.validator.addMethod("validDateFull",function(e,t){return this.optional(t)||function(e){if(!/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(e))return!1;var t=e.split("/"),a=parseInt(t[0],10),i=parseInt(t[1],10),e=parseInt(t[2],10),t=new Date;return!(e<1900||e>t.getFullYear()||0==a||12<a)&&(t=[31,28,31,30,31,30,31,31,30,31,30,31],(e%400==0||e%100!=0&&e%4==0)&&(t[1]=29),0<i&&i<=t[a-1])}(e)},function(e,t){return"Date format MM/DD/YYYY"}),$.validator.addMethod("validDateMonth",function(e,t){return this.optional(t)||function(e){if(!/^\d{1,2}\/\d{4}$/.test(e))return!1;var t=e.split("/"),a=parseInt(t[0],10),e=parseInt(t[1],10),t=new Date;return!(e<1700||e>t.getFullYear()||0==a||12<a)}(e)},function(e,t){return"Date format MM/YYYY"}),$.validator.addMethod("validDateYear",function(e,t){return this.optional(t)||function(e){if(!/^\d{4}$/.test(e))return!1;var t=new Date;return!(e<1700||e>t.getFullYear())}(e)},function(e,t){return"Date format YYYY"}),$(".form-application").each(function(){$(this).validate({ignore:':hidden:not([name="service"]), .fa-step-item:not(.slick-active) .form-control',submitHandler:function(e){var t=(e=$(e)).find('[type="submit"]'),e=e.serializeArray();t.disable(!0),r.loaderState("show"),(window.dataLayer||[]).push({event:"submit_form",completed_step:"completed-step-prepare-to-docusign"}),e.push({name:"step",value:"ds-init"}),1==r.cs&&(e.push({name:"cs",value:"true"}),r.cs=!1),$.ajax({method:"POST",url:"php/form-application.php",data:e,dataType:"json",complete:function(e){if("object"==typeof e.responseJSON){if("success"==e.responseJSON.response)return void(window.location.href=e.responseJSON.r);alert("It seems like we have a temporary problem. Please re-check all fields.")}else alert("Undefined error, please try again later.");t.disable(!1),r.loaderState("hide")}})},errorClass:"error",errorPlacement:function(e,t){t=$(t);t.hasClass("select-item")?e.insertAfter(t.next()):t.is('[name="service"]')?e.insertBefore("#fg-btn-submit button"):e.insertAfter(t)},highlight:function(e,t,a){e=$(e);(e.hasClass("select-item")?e.next():e).addClass(t)},unhighlight:function(e,t,a){e=$(e);(e.hasClass("select-item")?e.next():e).removeClass(t)}})});for(var e=["service","business_legal_name","business_term","business_email","annual_cards_vol","avg_sale","business_dba_name","products_service_sold","business_type","business_phone","business_tax_id","business_address_street","business_city","business_state","business_zip","first_name","last_name","title_name","ownership_perc","birth_date","personal_email","personal_phone","home_address_street","home_city","home_state","home_zip","social_security","account_number","routing_number"],t=0;t<e.length;t++)$('[name="'+e[t]+'"]').rules("add","required");$("[data-field-string]").each(function(){$(this).rules("add","validString")}),$('[type="email"]').each(function(){$(this).rules("add",{email:!1}),$(this).rules("add","validEmail")}),$('[name="business_term"]').rules("add","validDateYear"),$('[name="birth_date"]').rules("add","validDateFull"),$("[data-field-address]").each(function(){$(this).rules("add",{maxlength:50})}),$("[data-field-city]").each(function(){$(this).rules("add",{maxlength:30})}),$("[data-mask-phone]").each(function(){$(this).rules("add","validPhone")}),$("[data-mask-zip]").each(function(){$(this).rules("add","validZip")}),$("[data-mask-tax]").each(function(){$(this).rules("add","validTax")}),$("[data-mask-percentage]").each(function(){$(this).rules("add",{min:1,max:100})}),$("[data-mask-ssn]").each(function(){$(this).rules("add","validSSN")}),$('[name="service"]').rules("add",{messages:{required:"Please select device"}}),$('[name="service"]').on("change",function(){$(this).valid()}),$('[name="business_legal_name"]').on("keyup focusout",function(){$('[name="business_dba_name"]').val($(this).val())});$(document).on("mask-it",function(){$("[data-mask-phone]").mask("(000) 000-0000"),$("[data-mask-zip]").mask("00000"),$("[data-mask-tax]").mask("00-0000000"),$("[data-mask-ssn]").mask("000-00-0000"),$("[data-mask-rn]").mask("000000000"),$("[data-mask-an]").mask("00000999999999999999"),$("[data-mask-percentage]").mask("990",{clearIfNotMatch:!0,reverse:!0}),$("[data-mask-date]").mask("00/00/0000"),$("[data-mask-date-01]").mask("0000"),$("[data-mask-money]").each(function(){var r=$(this),o={onKeyPress:function(e,t,a,i){var s=["$0#","$0 00#","$00 000#","$000 000#","$0 000 000#","$00 000 000#","$000 000 000"],n="$0#",e=e.replace(/\s/g,"");e.length<=4?n=s[0]:5==e.length?n=s[1]:6==e.length?n=s[2]:7==e.length?n=s[3]:8==e.length?n=s[4]:9==e.length?n=s[5]:10==e.length&&(n=s[6]),r.mask(n,o)},clearIfNotMatch:!0,placeholder:"$"};r.mask("$0#",o)})}).trigger("mask-it"),$(".select-item").each(function(){var e=$(this);e.select2({placeholder:e.data("select-placeholder")&&0<e.data("select-placeholder").length?e.data("select-placeholder"):"Please select...",allowClear:!0,minimumResultsForSearch:e.is("[data-select-input]")?0:1/0})}),$(".select-item").on("change.s2v",function(){$(this).valid()}),$("[data-select-input]").on("select2:open",function(){$(".select2-search__field").focus()}),$(".form-files").each(function(){$(this).validate({submitHandler:function(e){var n=(e=$(e)).find('[type="submit"]'),e=new FormData(e[0]);n.disable(!0),r.loaderState("show"),$.ajax({method:"POST",url:"php/form-files.php",data:e,contentType:!1,processData:!1,dataType:"json",complete:function(e){if("object"==typeof e.responseJSON){if("success"==e.responseJSON.response){var t=r.parseJson(e.responseJSON.d);if("object"==typeof t&&"redirect_link"in t)return void(window.location.href=t.redirect_link);if(0<e.responseJSON.r.length)return void(window.location.href=e.responseJSON.r);alert("Undefined error, please try again later.")}else if("error"==e.responseJSON.response){for(var a=e.responseJSON.d,i=0;i<a.length;i++){var s=a[i];!1===s.error&&$('[name="'+s.field+'_s"]').val("s")}0==$(".fileinput-error-description").length&&$('<p class="fileinput-error-description">Please select JPG, PNG or PDF File, <span style="white-space: nowrap">maximum size of image: 10 MB.</span></p>').insertAfter($("#voided-check-photo"))}}else alert("Undefined error, please try again later.");n.disable(!1),r.loaderState("hide")}})},errorClass:"error",errorPlacement:function(e,t){t=$(t);t.hasClass("select-item")||t.hasClass("custom-file-input")?e.insertAfter(t.next()):e.insertAfter(t)},highlight:function(e,t,a){e=$(e);(e.hasClass("select-item")?e.next():e).addClass(t)},unhighlight:function(e,t,a){e=$(e);(e.hasClass("select-item")?e.next():e).removeClass(t)}})}),$("[data-mask-rn]").each(function(){$(this).rules("add",{validExactLength:9})}),$("[data-mask-an]").each(function(){$(this).rules("add",{minlength:5,maxlength:20})}),$(".custom-file-input").each(function(){$(this).on("change",function(){var e=$(this),t=e.val().split("\\").pop();t.length?(e.next(".custom-file-label").find(".cfl-text > span").text(t),e.addClass("custom-file-input-selected")):e.removeClass("custom-file-input-selected"),$(".fileinput-error-description").length&&$(".fileinput-error-description").remove(),e.valid()})});var r={form:$(".application-form-steps"),completedSteps:[],finalStepNum:1==$(".application-form-steps").children().length?0:$(".application-form-steps").children().length-1,cs:!1,currentStep:function(){return this.form.slick("slickCurrentSlide")},formBtnActivate:function(){this.form.find('[type="submit"]').prop("disabled",!1)},goToNextStep:function(e){var t=e.closest(".fa-step-item"),a=!0,i=!1;t.find(".form-control").each(function(){$(this).valid()||(a=!1)===i&&(i=$(this))}),a?((window.dataLayer||[]).push({event:"submit_form",completed_step:"completed-step-"+this.currentStep()}),this.saveInfo(e)):i.focus()},saveInfo:function(e){var t=this,a=t.form.serializeArray(),i=!1,s=t.currentStep(),n=$('[name="id"]'),r=$('[name="potential_savings"]');if(t.loaderState("show"),void 0!==e&&e.disable(i=!0),1==t.cs&&(a.push({name:"cs",value:"true"}),t.cs=!1),s==t.finalStepNum-1&&t.formBtnActivate(),-1!=t.completedSteps.indexOf(s))return t.loaderState("hide"),void(!0===i&&t.changeStep(s+1));$.ajax({method:"POST",url:"php/form-application.php",data:a,dataType:"json",complete:function(e){if("object"==typeof e.responseJSON&&"success"==e.responseJSON.response){if(1<e.responseJSON.r.length)return void(window.location.href=e.responseJSON.r);e=t.parseJson(e.responseJSON.d);"object"==typeof e&&(n.val(e.id),r.val(e.potential_savings)),t.showPotentialSavings()}!0===i&&(t.completedSteps.push(s),t.changeStep(s+1)),t.loaderState("hide")}})},parseJson:function(e){try{var t=JSON.parse(e);if(t&&"object"==typeof t)return t}catch(e){}return!1},changeStep:function(e){var t=this;$("#header").outerHeight();setTimeout(function(){$("html, body").scrollTop(0),t.form.slick("slickGoTo",e),$('[name="step"]').val(e)},1)},continueFromStep:function(){var e=this,t=$('[name="step"]').val(),a=parseInt(t,10),t=e.form.attr("data-form-cs");void 0!==t&&!1!==t&&e.currentStep()!==a&&(a==e.finalStepNum&&e.formBtnActivate(),e.cs=!0,e.form.slick("slickGoTo",a,!0)),e.form.addClass("form-application-initialized")},loaderState:function(e){var t=$(".loader-wrap"),a="loader-active";"show"==e?t.addClass(a):"hide"==e&&t.removeClass(a)},showPotentialSavings:function(){var e,t,a,i,s;$('[name="potential_savings"]').length&&(a=s=i="",0<(e=$('[name="potential_savings"]').val()).length&&(t=e.indexOf("$"),i=e.substring(t),s=e.substring(0,t),0<i.length&&0<s.length&&(a=(s=s.split(" "))[0]+"<br>"+s[1],$("#calc-annual-savings").text(i),$(".iil-description-01").html(a))),0==i.length||0==a.length?$(".potential-savings-result-wrap").css("display","none"):$(".potential-savings-result-wrap").css("display","block"))}};$("button[data-form-next-step]").on("click",function(){r.goToNextStep($(this))}),$(".application-form-steps").slick({dots:!1,arrows:!1,draggable:!1,swipe:!1,touchMove:!1,fade:!0,infinite:!1,speed:400,slidesToShow:1,adaptiveHeight:!0,accessibility:!1}),r.showPotentialSavings(),r.continueFromStep()}),$(function(){var t=!1;$(".fa-step-item .form-control").each(function(){$(this).on("focus",function(){var e=$(this);!1===t&&(t=e),e.closest(".fa-step-item").hasClass("slick-active")?t=e:t.focus()})}),$(".fa-step-item").each(function(){$(this).find(".form-control").each(function(a,e){var e=$(e),i=e.closest(".fa-step-item").find(".form-control");e.keydown(function(e){var t;9===(e.keyCode||e.which)&&(t=a==i.length-1?0:a+1,i[t].focus(),e.preventDefault())})})})});